<!DOCTYPE html>
<html lang="en">
  <head>
    <script type="module" defer>
      import { evaluateGraph } from './util/audio-comparer.js';

      // My Render Length (seconds)
      window.tests = {
        ...window.tests,
        graphEvalPromise: new Promise(async (resolve) => {
          const length = 1;
          // My DSP Graph (function)
          const myGraph = ctx => {
            const osc = new OscillatorNode(ctx);
            osc.type = 'sawtooth';
            const gain = new GainNode(ctx);
            gain.gain.value = 2.2;
            const biq = new BiquadFilterNode(ctx);
            biq.type = 'bandpass';
            biq.frequency.value = 1000;
            biq.Q.value = 10;
            osc.connect(gain).connect(biq).connect(ctx.destination);

            osc.start();
            osc.stop(ctx.currentTime + length);
          }

          const score = await evaluateGraph(myGraph, length);
          resolve({ "score": score });
        })
      }
    </script>
    <title>DSP Graph Evaluation</title>
  </head>
  <body>
    <h1>DSP Graph Evaluation</h1>
    <p>Build a DSP graph with both realtime AudioContext and OfflineContext. Record output buffers and compare
      differences.</p>
  </body>
</html>